<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;700&display=swap" rel="stylesheet">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet"> -->
    <link rel="stylesheet" href="css/style.css">
    <script src="//assets.adobedtm.com/e3d6d7658cf1/05deee267e30/launch-5defa87cd17b.min.js"></script>
    <title>Smart Dimensions Home Page</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#"><img src="images/logo.png" alt="logo" /> We Media</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link" href="#">Movies <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">TV</a>
                </li>

                <li class="nav-item active">
                    <a class="nav-link" href="#">Sports</a>
                </li>
            </ul>
            <div class="nav-item search">
                <input type="text">
                <img src="images/search.png">
            </div>
            <div class="nav-item drop">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">
                    <img src="./images/user-image.png">
                    <span id='username'></span>
                </a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item btn" id='logout'>Logout</a>
                </div>
            </div>
        </div>
    </nav>
    <div class="container-fluid">
        <div class="row">

            <div class="owl-carousel">
                <div class="item" style="background-image: url('./images/New-Zealand-Women.jpg')">
                    <div class="content">

                        <h2>Highlights: Oz Seal Semis Berth</h2>
                        <p>Beth Mooney's well compiled 60 off 50 balls powered Australia to a 4-run victory against New
                            Zealand in the ICC Women's T20 World Cup 2020</p>
                        <a href="#" class="modal-open"
                            videoUrl='https://exceed-sd.s3-us-west-1.amazonaws.com/video/roller_skates_2.mp4'><img
                                src="./images/watch.png" class="watch" /> Watch Now</a>
                    </div>
                </div>
                <div class="item" style="background-image: url('./images/live-watch.PNG')">
                    <div class="content">

                        <h2>Ethiopia Tops, Oz Stumble</h2>
                        <p>Bolt-led All-Stars win the 4x100 Mixed Relay and go on top of the leaderboard as Australia
                            get disqualified</p>
                        <a href="#" class="modal-open" videoUrl='./video/DemoVideo.mp4'><img src="./images/watch.png"
                                class="watch" /> Watch Now</a>
                    </div>
                </div>
                <div class="item" style="background-image: url('./images/Badminton.jpg')">
                    <div class="content">

                        <h2>Highlights: Jayaram Bows out in SF</h2>
                        <p>India's Ajay Jayaram went down fighting to Thailand's Kunlavut Vitidsarn 20-22 12-22 in the
                            semifinals of the Barcelona Spain Masters 2020</p>
                        <a href="#" class="modal-open"
                            videoUrl='https://exceed-sd.s3-us-west-1.amazonaws.com/video/car_racing_2.mp4'><img
                                src="./images/watch.png" class="watch" /> Watch Now</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid custom-container card-list">
        <div class="row">
            <div class="col-md-3 col-12 col-sm-6 col-lg-3">
                <div class="card">
                    <img src="images/card-image.jpg" alt="card-image">
                    <div class="card-body">
                        <div class="text-center">
                            <img src="images/playIcon.png" class="modal-open"
                                videoUrl='https://exceed-sd.s3-us-west-1.amazonaws.com/video/JustForFun.mp4'>
                        </div>
                        <h3>Running Mile</h3>
                        <p>I trained 8 weeks to run a 5 minute mile. Here's how it went</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-12 col-sm-6 col-lg-3">
                <div class="card">
                    <img src="images/Mask%20Group%206.png" alt="card-image">
                    <div class="card-body">
                        <div class="text-center">
                            <img src="images/playIcon.png" class="modal-open">
                        </div>
                        <h3>India vs. New Zeland</h3>
                        <p>Find out how the players are doing in the Test <br /> series</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-12 col-sm-6 col-lg-3">
                <div class="card">
                    <img src="images/Mask%20Group%205.png" alt="card-image">
                    <div class="card-body">
                        <div class="text-center">
                            <img src="images/playIcon.png" class="modal-open">
                        </div>
                        <h3>Performance of the year</h3>
                        <p>Star raider Pawan's haul with a record-breaking performance.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-12 col-sm-6 col-lg-3">
                <div class="card">
                    <img src="images/Group%2023.png" alt="card-image">
                    <div class="card-body">
                        <div class="text-center">
                            <img src="images/playIcon.png" class="modal-open">
                        </div>
                        <h3>Watford 3-0 Liverpool</h3>
                        <p>Liverpool's dreams of an unbeaten Premier League 2019/20 season ...</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-12 col-sm-6 col-lg-3">
                <div class="card">
                    <img src="images/card-image.jpg" alt="card-image">
                    <div class="card-body">
                        <div class="text-center">
                            <img src="images/playIcon.png" class="modal-open"
                                videoUrl='https://exceed-sd.s3-us-west-1.amazonaws.com/video/JustForFun.mp4'>
                        </div>
                        <h3>Running Mile</h3>
                        <p>I trained 8 weeks to run a 5 minute mile. Here's how it went</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-12 col-sm-6 col-lg-3">
                <div class="card">
                    <img src="images/Mask%20Group%206.png" alt="card-image">
                    <div class="card-body">
                        <div class="text-center">
                            <img src="images/playIcon.png" class="modal-open">
                        </div>
                        <h3>India vs. New Zeland</h3>
                        <p>Find out how the players are doing in the Test <br /> series</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-12 col-sm-6 col-lg-3">
                <div class="card">
                    <img src="images/Mask%20Group%205.png" alt="card-image">
                    <div class="card-body">
                        <div class="text-center">
                            <img src="images/playIcon.png" class="modal-open">
                        </div>
                        <h3>Performance of the year</h3>
                        <p>Star raider Pawan's haul with a record-breaking performance.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 col-12 col-sm-6 col-lg-3">
                <div class="card">
                    <img src="images/Group%2023.png" alt="card-image">
                    <div class="card-body">
                        <div class="text-center">
                            <img src="images/playIcon.png" class="modal-open">
                        </div>
                        <h3>Watford 3-0 Liverpool</h3>
                        <p>Liverpool's dreams of an unbeaten Premier League 2019/20 season ...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" data-backdrop="static" id="exampleModal" tabindex="-1" role="dialog"
        aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="ads">
                    <div class="left"></div>
                    <div class="bottom">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-8">

                                    <h2>NIKE AIR ZOOM <sub>Mens Running Shoe</sub></h2>
                                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent id egestas
                                        justo. Vivamus ac ex at ligula convallis gravida. Quisque bibendum tristique
                                        neque ut laoreet. In non enim mollis, elementum nibh eget, consequat magna. In
                                        hac habitasse platea dictumst. Pellentesque auctor vitae lectus eu lobortis.
                                    </p>
                                    <h2>$190</h2>
                                </div>
                                <div class="align-items-center button-section col-md-4 d-flex flex-column">
                                    <button class="shop-now-button" id='shop-now-button'>Get It Now</button>
                                    <div class="col-md-4" id='shoe-ad' style="display: none;">

                                    </div>
                                    <div class="align-items-center col-md-8 flex-column" id='shoe-ad-details'
                                        style="display: none;">
                                        <p class='m-0 text-center font-weight-bold' style='font-size: 12px;'>Product is
                                            available in stock!</p>
                                        <div class='d-flex p-1'>
                                            <div class="color-block" style='background: #616161;'>

                                            </div>
                                            <div class="color-block" style='background: #B5B5B5;'>

                                            </div>
                                            <div class="color-block" style='background: #D36C6C;'>

                                            </div>
                                        </div>
                                        <p class="mb-1" style='font-size: 12px;'>Size 10 â–¼</p>
                                        <button class="cart-button shop-now-button" id='cart-button'>ADD TO
                                            CART</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-body">
                    <div id="percentage-indicator">
                    </div>
                    <button type="button" class="close video-full-screen">
                        <span aria-hidden="true"><img src="./images/full-screen.png" /></span>
                    </button>
                    <button type="button" class="close modal-close">
                        <span aria-hidden="true"><img src="./images/close.png" /></span>
                    </button>
                    <div class="suggestion-generated">
                        <h3>Segements Generated</h3>
                        <ul>
                            <div id="spinner-loading">
                                <div class="spinner-border" role="status"> <span class="sr-only">Loading...</span>
                                </div>
                            </div>
                        </ul>

                        <a><img src="./images/left-arrow.png" /></a>
                    </div>
                    <div class="suggestion-generated added">
                        <h3>Segements Added</h3>
                        <ul>
                            <div id="spinner-loading">
                                <div class="spinner-border" role="status">
                                    <span class="sr-only">Loading...</span>
                                </div>
                            </div>
                        </ul>
                        <a><img src="./images/right-arrow.png" /></a>
                    </div>
                    <video id="video">
                        <source src="https://exceed-sd.s3-us-west-1.amazonaws.com/video/JustForFun.mp4"
                            type="video/mp4">
                    </video>
                    <div class="seek" style="color: #fff">
                        <i></i>
                        <div id="custom-seekbar">

                            <span></span>

                        </div>
                        <i></i>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/script.js"></script>
    <script>
        // "f6171253512D2B8C0A490D45@AdobeOrg"
        var userId = ''
        var ecID = ''
        var token = 'eyJ4NXUiOiJpbXNfbmExLWtleS0xLmNlciIsImFsZyI6IlJTMjU2In0.eyJpZCI6IjE1ODc5ODczMTkzNDlfYzFhZTYxZGMtNmNiNC00NmE4LTkwMTAtMGRhNDc5Y2M4NjYwX3VlMSIsImNsaWVudF9pZCI6IjI3NjFlZWEwYjc2NjRhOTdhOTZhODk4OWM5NGY3YzgyIiwidXNlcl9pZCI6IjI0QTgxMkQ5NTI5RUM2NzYwQTQ5MEQ0NEBBZG9iZUlEIiwic3RhdGUiOiIiLCJ0eXBlIjoicmVmcmVzaF90b2tlbiIsImFzIjoiaW1zLW5hMSIsImZnIjoiVU1MWE83T1lYUE81NTc2Mkc2WUxTN1FBUVE9PT09PT0iLCJzaWQiOiIxNTg3OTg2NzEyMDg1XzBkZmNhNWZmLTNlMzUtNDQ4NC05YzQ5LTVlYTllMzJlMGFhYl91ZTEiLCJleHBpcmVzX2luIjoiMTIwOTYwMDAwMCIsImNyZWF0ZWRfYXQiOiIxNTg3OTg3MzE5MzQ5Iiwic2NvcGUiOiJvcGVuaWQsQWRvYmVJRCJ9.NCXp6os1kYe3FryftzuHYXsBLX9UWvouCC-kP6hiOa0KhKqfN0-9Wcn-zFMSgnMOuvZpRtz1fDXCDLzbiuWg-epBGXTdDPvTfiWUq6VHACTKCDlQiwFAycLuKSX6KjPpjLCBlOcF2R6EEpUIKBBkHgPbodb0QKA3ayRVgK1nRDCYo4_rpKV2UUmYoyZtXFwE32-EI_5UaUxzm44DX9y8A2Bbs3w44eqD286rCulj_ruCrqxBbTBvUcNmVcgQrbqBy8X7yx3C8hVIKa9lwvbm5FlfVx3_DMA4xHwI_9YvaADKOElbSJARj28l0Id6_Hnv4ydH3OqkDTlf9eQTB1-kqw'
        var stats = [false, false, false, false];
        fetchImage('dog');
        $(document).ready(() => {
            if (!localStorage.getItem("userId")) {
                window.location.href = 'index.html'
            } else {
                userId = localStorage.getItem("userId");
                $('#username').html(userId)
                var visitor = Visitor.getInstance('f6171253512D2B8C0A490D45@AdobeOrg');
                var mcvID = visitor.getMarketingCloudVisitorID()
                debugger;
                localStorage.setItem("ecID", mcvID)
                ecID = mcvID
            }
            $('#logout').click(() => {
                localStorage.removeItem('userId')
                localStorage.removeItem('ecID')
                window.location.href = 'index.html'
            })
        })
        var vid = document.getElementById("video");
        function modalClose() {
            $("#exampleModal").modal('hide');
            vid.pause();
        }

        $('.modal-close').on('click', function () {
            $(".modal-content").removeClass('ad-display')
            modalClose();
        })
        function modalOpen(videoUrl) {
            stats = [false, false, false, false];
            $(".modal-content").removeClass('ad-display')
            fileURL = videoUrl ? videoUrl : './video/DemoVideo.mp4'
            let baseUrl = ''
            let videoDetails = {};
            videoDetails.videoName = fileURL.split('/').pop();
            videoDetails.videoName = videoDetails.videoName.split('.')[0];
            videoDetails.videoId = videoDetails.videoName + '042020';
            if (fileURL == './video/DemoVideo.mp4') { //if its demo 
                var data = {
                    url: fileURL,
                    products: [{
                        url: 'https://www.adobe.com',
                        title: 'Apple Watch',
                        description: 'Product Description',
                        confidence: '0.96',
                        image: './images/product-image.png',
                        startSecond: 10,
                        endSecond: 25
                    }, {
                        url: 'https://www.adobe.com',
                        title: 'Nike Shoes',
                        description: 'Product Description',
                        confidence: '0.9',
                        image: './images/Mask Group 16.png',
                        startSecond: 20,
                        endSecond: 25
                    }, {
                        url: 'https://www.adobe.com',
                        title: 'Running Shorts',
                        description: 'Product Description',
                        confidence: '0.95',
                        image: './images/Mask Group 17.png',
                        startSecond: 20,
                        endSecond: 25
                    }, {
                        url: 'https://www.adobe.com',
                        title: 'Tank Top',
                        description: 'Product Description',
                        confidence: '0.89',
                        image: './images/Mask Group 18.png',
                        startSecond: 20,
                        endSecond: 25
                    }]
                };
                this.showModal(fileURL, videoDetails);
                this.showVideoTags(data.products, videoDetails);
            } else {
                this.showModal(fileURL, videoDetails);
                $('.owl-carousel').trigger('stop.owl.autoplay')
                video_id = 'JustForFun042020'
                login_id = userId
                ecid = ecID
                let imageArray = {};
                baseUrl = `http://54.177.241.77:3000/video/getTags?fileURL=${fileURL}&video_id=${video_id}&login_id=${login_id}&ecid=${ecid}`
                $.ajax({
                    url: baseUrl,
                    type: "POST",
                    success: (data) => {
                        let output = [];

                        data['cas_responses']['0']['result']['response']['classification_entries'].map((item) => {
                            if(!imageArray[item['class'].name]){
                                //wait for image before pushing
                                fetchImage(item['class'].name).then((response) => {
                                    response = response['files'][0]['thumbnail_url'];
                                    imageArray[item['class'].name] = response;
                                    if (item['class']['meta-info']['temporal-info']) {
                                        item['class']['meta-info']['temporal-info'].map((tags) => {
                                            output.push({
                                                url: 'https://www.adobe.com',
                                                title: item['class'].name,
                                                description: 'Product Description',
                                                confidence: (tags.confidence).toFixed(2),
                                                image: imageArray[item['class'].name],
                                                startSecond: (tags['timestamp-in-ms'] / 1000),
                                                endSecond: ((tags['timestamp-in-ms'] / 1000) + 3)
                                            })
                                        })
                                    }
                                })
                            }else{
                                //image already fetched
                                if (item['class']['meta-info']['temporal-info']) {
                                item['class']['meta-info']['temporal-info'].map((tags) => {
                                    output.push({
                                        url: 'https://www.adobe.com',
                                        title: item['class'].name,
                                        description: 'Product Description',
                                        confidence: (tags.confidence).toFixed(2),
                                        image: imageArray[item['class'].name],
                                        startSecond: (tags['timestamp-in-ms'] / 1000),
                                        endSecond: ((tags['timestamp-in-ms'] / 1000) + 3)
                                    })
                                })
                            }
                            }
                        })
                        $('#overlay').hide();
                        // this.showModal(finalData);
                        this.showVideoTags(output, videoDetails);
                    },
                    error: (err) => {
                        let finalData = { url: fileURL };
                        this.showModal(finalData);
                        console.log('Sensie aoi error ' + err)
                    }
                })
            }
        }

        function showVideoTags(tagsArray, videoDetails) {
            vid.ontimeupdate = function () {
                var percentage = (vid.currentTime / vid.duration) * 100;
                var currentTime = Math.round(vid.currentTime, 1);
                var oldTime = 0;
                if (oldTime == currentTime) {
                    return;
                }
                oldTime = currentTime;
                $("#custom-seekbar span").css("width", percentage + "%");
                $('.seek i:first-of-type').text(timeUpdate(vid.currentTime));
                var items = tagsArray.filter(function (item) {
                    return currentTime >= item.startSecond && currentTime <= item.endSecond;
                });
                updateSuggestion(items, percentage)
                percentageEventTriggers(percentage, videoDetails)
            };
            vid.addEventListener('ended', myHandler, false);
            function myHandler(e) {
                console.log('complete')
                //    $(".modal-content").addClass('ad-display');
                $(".suggestion-generated:not(.added) > ul").html('');
                //get random 5
                let random5 = tagsArray.map(x => ({ x, r: Math.random() })).sort((a, b) => a.r - b.r).map(a => a.x).slice(0, 5);
                var html = '';
                $.each(random5, function (index, value) {
                    html += '<a href="' + value.url + '" target="_blank"><li><img src="' + value.image + '" /><div class="content"><h4>' + value.title + '</h4><p>Confidence: ' + value.confidence + '</p></div></li></a>'
                });
                $(".suggestion-generated.added > ul").html(html);
            }
            $('.owl-carousel').trigger('play.owl.autoplay', [4000])
        }


        function percentageEventTriggers(percentage, videoDetails) {
            let videoName = videoDetails.videoName;
            let videoId = videoDetails.videoId;

            if (percentage >= 25.00 && percentage <= 28) {
                if (stats[0] == false)
                    console.log('custom event called on video status 25%')
                $('#percentage-indicator').html('25% complete')
                var ev3 = new CustomEvent('videoMilestone25', {
                    detail: {
                        videoId: videoId,
                        videoGenre: 'running',
                        videoName: videoName, //change this to name later
                        videoLength: vid.duration,
                        videoPlayerName: 'html5 player',
                        page: document.title,
                        siteSection: 'Video:Sports',
                        lang: 'EN',
                        loginStatus: 'loggedIn',
                        videoStatus: 'videoMilestone25'
                    }
                });
                document.body.dispatchEvent(ev3);
                stats[0] = true;
            }
            //50% Milestone
            else if (percentage >= 50.00 && percentage <= 53) {
                if (stats[1] == false)
                    console.log('custom event called on video status 50%')
                $('#percentage-indicator').html('50% complete')

                var ev4 = new CustomEvent('videoMilestone50', {
                    detail: {
                        videoId: videoId,
                        videoGenre: 'running',
                        videoName: videoName, //change this to name later
                        videoLength: vid.duration,
                        videoPlayerName: 'html5 player',
                        page: document.title,
                        siteSection: 'Video:Sports',
                        lang: 'EN',
                        loginStatus: 'loggedIn',
                        videoStatus: 'videoMilestone50'
                    }
                });
                document.body.dispatchEvent(ev4);
                stats[1] = true

            }
            //75% Milestone
            else if (percentage >= 75.00 && percentage <= 78) {
                if (stats[2] == false)
                    console.log('custom event called on video status 75%')
                $('#percentage-indicator').html('75% complete')

                var ev5 = new CustomEvent('videoMilestone75', {
                    detail: {
                        videoId: videoId,
                        videoGenre: 'running',
                        videoName: videoName, //change this to name later
                        videoLength: vid.duration,
                        videoPlayerName: 'html5 player',
                        page: document.title,
                        siteSection: 'Video:Sports',
                        lang: 'EN',
                        loginStatus: 'loggedIn',
                        videoStatus: 'videoMilestone75'
                    }
                });
                document.body.dispatchEvent(ev5);
                stats[2] = true
            }
            else if (percentage >= 80) {
                if (stats[3] == false) {
                    //add is loaded
                    $(".modal-content").addClass('ad-display');

                    //call this only once
                    console.log('Custom event called once the ad is shown(should be called only once)')
                    var ev = new CustomEvent('videoAdShown', {
                        detail: {
                            videoId: videoDetails.videoId,
                            videoGenre: 'sports:cricket',
                            videoName: videoDetails.videoName,
                            page: document.title,
                            siteSection: 'Video: Sports',
                            lang: 'EN',
                            loginStatus: 'loggedIn', //loggedOut,
                            adCampaignId: 'nikedisplayad12345'
                        }
                    });
                    document.body.dispatchEvent(ev);
                    stats[3] = true;
                }
            }
            else {
                $('#percentage-indicator').html('')
                $(".modal-content").removeClass('ad-display')
            }
        }

        function fetchImage(item) {
            return $.ajax({
                url: `https://stock.adobe.io/Rest/Media/1/Search/Files?locale=en_US&search_parameters[words]=${item} closeup&search_parameters[limit]=1`,
                method: "GET",
                headers: {
                    "Authorization" : "Bearer " + token,
                    "x-api-key": '2761eea0b7664a97a96a8989c94f7c82',
                    "x-Product": 'MySampleApp/1.0'
                }
            });
        }
        function showModal(url, videoDetails) {

            let sendAdData = false;

            // var response = JSON.parse(data.responseText);
            $('#exampleModal').modal('show');

            $(".suggestion-generated:not(.added) > ul").html('<div id="spinner-loading"> <div class="spinner-border" role="status"> <span class="sr-only">Loading...</span> </div> </div>');
            $(".suggestion-generated.added > ul").html('<div id="spinner-loading"> <div class="spinner-border" role="status"> <span class="sr-only">Loading...</span> </div> </div>');
            //https://v.ftcdn.net/01/19/51/24/700_F_119512479_LnlcYzOimjgBsqgAsdshLBTKfBmp8tWJ_ST.mp4


            vid.src = url;
            vid.play();

            vid.ontimeupdate = function () {
                var percentage = ((vid.currentTime / vid.duration) * 100);
                var currentTime = Math.round(vid.currentTime, 1);
                var oldTime = 0;
                if (oldTime == currentTime) {
                    return;
                }
                oldTime = currentTime;


                //starts percentage event triggers
                percentageEventTriggers(percentage, videoDetails);
                $("#custom-seekbar span").css("width", percentage + "%");
                $('.seek i:first-of-type').text(timeUpdate(vid.currentTime));
            }



            vid.onloadedmetadata = function () {
                var ev = new CustomEvent('videoPlayerLoad', {
                    detail: {
                        videoId: 'JustForFun042020',
                        videoGenre: 'sports:cricket',
                        videoName: 'JustForFun',
                        videoLength: parseInt(vid.duration),
                        videoPlayerName: 'html5 player',
                        paage: document.title,
                        siteSection: 'Video: Sports',
                        lang: 'EN',
                        loginStatus: 'loggedIn' // loggedOut
                    }
                });
                document.body.dispatchEvent(ev);
            };

        }

        function timeUpdate(seconds) {
            var secs = Math.round(seconds);
            var hours = Math.floor(seconds / (60 * 60));
            var divisor_for_minutes = seconds % (60 * 60);
            var minutes = Math.floor(divisor_for_minutes / 60);
            var divisor_for_seconds = divisor_for_minutes % 60;
            var seconds = Math.ceil(divisor_for_seconds);
            if (hours < 10) {
                hours = '0' + hours;
            }
            if (minutes < 10) {
                minutes = '0' + minutes;
            }
            if (seconds < 10) {
                seconds = '0' + seconds;
            }
            return hours + ":" + minutes + ':' + seconds;
        }
        $("#custom-seekbar").on("click", function (e) {
            var offset = $(this).offset();
            var left = (e.pageX - offset.left);
            var totalWidth = $("#custom-seekbar").width();
            var percentage = (left / totalWidth);
            var vidTime = vid.duration * percentage;
            vid.currentTime = vidTime;
            vid.play();
        });
        $('.modal-open').on('click', function () {
            $(".modal-content").removeClass('ad-display')
            modalOpen($(this).attr('videoUrl'));
        })
        function updateSuggestion(data) {
            var html = '';
            $.each(data, function (index, value) {
                html += '<a href="' + value.url + '" target="_blank"><li><img src="' + value.image + '" /><div class="content"><h4>' + value.title + '</h4><p>Confidence: ' + value.confidence + '</p></div></li></a>'
            });

            $(".suggestion-generated:not(.added) > ul").html(html);
            if (data.length !== 0) {

                //    $(".suggestion-generated.added > ul").html(html);
            }
        }
        $('.owl-carousel').owlCarousel({
            stagePadding: 100,
            loop: true,
            margin: 10,
            nav: true,
            autoplay: true,
            autoplayTimeout: 4000,
            responsive: {
                0: {
                    items: 1
                },
                600: {
                    items: 1
                },
                1000: {
                    items: 1
                }
            }
        });
        $('.video-full-screen').on('click', toggleFullScreen);
        function toggleFullScreen() {
            if (vid.requestFullScreen) {
                vid.requestFullScreen();
            } else if (vid.webkitRequestFullScreen) {
                vid.webkitRequestFullScreen();
            } else if (vid.mozRequestFullScreen) {
                vid.mozRequestFullScreen();
            }
        }

        $('.suggestion-generated > a').on('click', function () {

            $(this).closest('.suggestion-generated').toggleClass('show');
        })

        var animateButton = function (e) {
            e.preventDefault;
            //reset animation
            if (!e.target.classList.contains('email-send-btn')) {
                e.target.classList.remove('animate');

                e.target.classList.add('animate');
                setTimeout(function () {
                    e.target.classList.add('success');
                    $('#shop-now-button').html('EMAIL SENT').addClass('email-send-btn');
                }, 3000);
            }
            else {

                $('#shop-now-button').hide()
                $('.button-section').addClass('d-flex')
                $('#shoe-ad-details').addClass('d-flex').show()
                $('#shoe-ad').show()
                $('#email-send-btn').hide()
            }
        };

        var animateButton2 = function (e) {
            e.preventDefault;
            $('#shoe-ad').hide()
            $('#shoe-ad-details *:not(button)').hide()
            //reset animation
            e.target.classList.remove('animate');

            e.target.classList.add('animate');
            setTimeout(function () {
                e.target.classList.add('success');
                $('.shop-now-button').html('CART UPDATED')
                setTimeout(function () {
                    $('.shop-now-button').removeClass('animate success').addClass('cart-updated')
                }, 3000);
            }, 3000);
        };


        $('#shop-now-button').click(animateButton);
        $('#cart-button').click(animateButton2);
    </script>
</body>

</html>